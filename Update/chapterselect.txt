
void main()
{

	PlayBGM( 2, "lsys13", 128, 0 );

	DrawSceneWithMask( "black", "2", 0, 0, 500 );

	Wait(500);

	DrawScene("scenario_a", 500);

	DrawSceneWithMask( "scenario_select", "5", 0, 0, 500 );

	EnableJumpingOfReturnIcon();
	
	OutputLine(NULL, "",
		   NULL, "", Line_ContinueAfterTyping);
	ClearMessage();
	
	char Chapter[3];

	if(GetGlobalFlag(GLanguage) == 1)
	{
		Chapter[0] = "Someutsushi";
		Chapter[1] = "Kageboushi";
		Chapter[2] = "Back";
	}
	else
	{
		Chapter[0] = "染伝し編";
		Chapter[1] = "影紡し編";
		Chapter[2] = "戻る";
	}

//	InitializeSelectedItem();
	Select( 3, Chapter );
	DisableWindow();
	if(LoadValueFromLocalWork( SelectResult ) == 0)
	{
		DrawScene( "scenario_a", 500 );
		DrawSceneWithMask( "scenario_b", "5", 0, 0, 500 );
		DrawSceneWithMask( "scenario_c", "5", 0, 0, 500 );

		ShowChapterPreview();

		if(LoadValueFromLocalWork( LOCALWORK_NO_RESULT ) == 1)
		{
			StopBGM( 2 );
			PlaySE( 1, "wa_037", 128, 64 );
	
			SetValidityOfSaving( TRUE );
			CallSection("Someutsushi");
		}
		else
		{
			StopBGM( 2 );
			DrawScene("black", 500);
			CallScript( "flow" );
		}
	}
	else if(LoadValueFromLocalWork( SelectResult ) == 1)
	{
		DrawScene( "scenario_a", 500 );
		DrawSceneWithMask( "scenario_b_kage", "5", 0, 0, 500 );
		DrawSceneWithMask( "scenario_c_kage", "5", 0, 0, 500 );

		ShowChapterPreview();

		if(LoadValueFromLocalWork( LOCALWORK_NO_RESULT ) == 1)
		{
			StopBGM( 2 );
			PlaySE( 1, "wa_037", 128, 64 );
	
			SetValidityOfSaving( TRUE );
			CallSection("Kageboushi");
		}
		else
		{
			StopBGM( 2 );
			DrawScene("black", 500);
			CallScript( "flow" );
		}
	}
	else
	{
		StopBGM( 2 );
		DisableWindow();
		DrawScene("black", 500);
		CallScript( "flow" );
	}
	
}

void SetDay()
{
	int chapter;
	chapter = LoadValueFromLocalWork( ChapterNumber );

	SetLocalFlag(LHimatsubushiDay, chapter);

	if(GetGlobalFlag(GHimatsubushiDay) < chapter)
		SetGlobalFlag(GHimatsubushiDay, chapter);
}

void Someutsushi()
{
	CallScript( "some_001" );
	CallScript( "some_002" );
	CallScript( "some_003" );
	CallScript( "some_004" );
	CallScript( "some_005" );
	CallScript( "some_006" );
	CallScript( "some_007" );
	CallScript( "some_008" );
	CallScript( "some_009" );
	CallScript( "some_010" );
	CallScript( "some_011" );
	CallScript( "some_012" );
	CallScript( "some_013" );
	CallScript( "some_014" );
	
	CallScript( "flow" );
}

void Kageboushi()
{
	CallScript( "kage_001" );
	CallScript( "kage_002" );
	CallScript( "kage_003" );
	CallScript( "kage_004" );
	CallScript( "kage_005" );
	CallScript( "kage_006" );
	CallScript( "kage_007" );
	CallScript( "kage_008" );
	CallScript( "kage_009" );
	CallScript( "kage_010" );
	CallScript( "kage_011" );
	CallScript( "kage_012" );
	
	CallScript( "flow" );
}
